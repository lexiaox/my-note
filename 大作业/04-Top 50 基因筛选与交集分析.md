---
创建时间: 2025-12-24 17:38
tags:
  - 大作业
status: 📝 编写中
---

## 任务：Top 50 基因筛选 (C语言实现)

### 1. 技术路线
为了坚持"Pure C"原则，我放弃了 Linux CLI 工具，转而实现了一个基于 `qsort` 和 `struct` 的后处理程序。

### 2. Pains (痛点)
- **多维度排序**: 需要对同一组数据按不同列（T1, T2, T3）进行三次独立排序。如果直接移动结构体数据，效率低且乱。
- **解决方案**: 创建了三个 `int` 类型的**索引数组 (Index Arrays)** `idx1, idx2, idx3`。`qsort` 排序的是索引，而不是庞大的结构体本身。这模拟了数据库中"索引"的概念。

### 3. Gains (收获)
- **指针与索引**: 深刻理解了 `Indirect Sorting`（间接排序）的优势——数据不动，指针动。
- **算法复杂度**: 虽然寻找交集用了 $O(N^3)$ 的嵌套循环，但因为 $N$ 仅为 50，计算量极小，这体现了在工程中"根据数据规模选择最简单算法"的实用主义。

## 4.遇到的问题

“最初，分析结果一无所获。经过调查，我发现样本间存在 **108 倍的测序深度偏差** （26M 对 0.24M）。
 
标准工具（比如 R/Seurat）会自动处理这些，隐藏了复杂性。因为我从零开始用 C 语言编程，所以我必须实现**一个双遍流式算法** ：

1. 
    **第一轮** ：271 个样本的聚合文库大小。
    
2. **通过 2**：在 T 检验前进行实时 **CPM 规范化**以标准化数据。
    

这成功纠正了系统偏差，并揭示了显著的共同基因。”