

`journalctl` 是一个用于查看和操作由 **Systemd** 的**日志守护进程**（`systemd-journald`）收集的日志的工具。Systemd Journal 是现代 Linux 系统中日志管理的核心，它统一了所有内核、系统进程和服务产生的日志，并以二进制格式存储。

`journalctl` 的强大之处在于其灵活的过滤和格式化能力。

---

## 💻 `journalctl` 基本用法

| **命令**                              | **功能描述**                                                            |
| ----------------------------------- | ------------------------------------------------------------------- |
| **`journalctl`**                    | **查看所有日志**。按时间顺序显示所有可访问的日志信息，从最早的一条开始。                              |
| **`journalctl -r`**                 | **逆序显示**。从最新的日志开始，向后显示。                                             |
| **`journalctl -f`**                 | **实时追踪**（Follow）。类似于 `tail -f`，实时显示正在写入的新日志条目。                      |
| **`journalctl --disk-usage`**       | **查看磁盘使用情况**。显示日志文件在磁盘上占用的空间大小。                                     |
| **`journalctl --vacuum-size=500M`** | **清理日志**。将日志文件大小限制在 500MB 以内。您也可以使用 `--vacuum-time` 按时间清理（例如 `1y`）。 |

---

## 🔎 按时间或启动过滤

这是 `journalctl` 最常用的功能之一，允许您精确锁定特定的时间段或启动会话。

### 📅 按时间过滤

|**选项**|**描述**|**示例**|
|---|---|---|
|**`-S`** 或 **`--since`**|显示从指定时间**开始**的日志。|`journalctl -S "2 hours ago"`|
|**`-U`** 或 **`--until`**|显示到指定时间**为止**的日志。|`journalctl -U "2025-12-05 10:00:00"`|
|**两者结合**|查看某一时间段内的日志。|`journalctl -S 14:00 -U 14:30`|

> 📌 **时间格式支持：** 您可以使用相对时间（如 `yesterday`、`30 min ago`）或绝对时间（如 `2025-12-05 10:00:00`）。

### ⏱️ 按启动过滤 (`-b`)

如您之前所提，`journalctl -b` 用于过滤特定启动会话的日志：

|**选项**|**描述**|**示例**|
|---|---|---|
|**`-b`** 或 **`-b 0`**|显示**当前**启动的日志。|`journalctl -b`|
|**`-b -1`**|显示**前一次**启动的日志。|`journalctl -b -1`|
|**`-b <数字>`**|显示指定启动 ID 的日志（例如 `journalctl --list-boots` 查看所有 ID）。|`journalctl -b 2`|
|**`--list-boots`**|列出所有记录的启动会话，包括启动 ID 和时间戳。|`journalctl --list-boots`|

---

## 🛠️ 按字段或来源过滤

您可以根据日志条目的来源（如单元、进程、用户）进行过滤。

|**选项**|**描述**|**示例**|
|---|---|---|
|**`-u`** 或 **`--unit`**|仅显示指定 **Systemd 单元**（服务）的日志。|`journalctl -u sshd.service`|
|**`_PID=`**|仅显示指定 **进程 ID (PID)** 的日志。|`journalctl _PID=1234`|
|**`_SYSTEMD_UNIT=`**|类似于 `-u`，用于单元日志。|`journalctl _SYSTEMD_UNIT=nginx.service`|
|**`-k`**|仅显示**内核日志**（`dmesg` 的等价物）。|`journalctl -k`|
|**`-p`** 或 **`--priority`**|仅显示指定**优先级**（或更高）的日志。|`journalctl -p err`|

> 💡 **优先级 (Priority) 级别：**
> 
> - **`emerg`** (0) - 紧急
>     
> - **`alert`** (1) - 警戒
>     
> - **`crit`** (2) - 临界
>     
> - **`err`** (3) - 错误 (Errors)
>     
> - **`warning`** (4) - 警告 (Warnings)
>     
> - **`notice`** (5) - 通知
>     
> - **`info`** (6) - 信息 (Informational)
>     
> - **`debug`** (7) - 调试
>     

---

## 🎨 格式化输出

|**选项**|**描述**|**示例**|
|---|---|---|
|**`-o json`**|以 **JSON** 格式显示日志条目，适合脚本处理。|`journalctl -b -o json`|
|**`-o verbose`**|以**完整**的详细格式显示所有内部字段。|`journalctl -n 1 -o verbose`|
|**`-o short-iso`**|使用 **ISO 8601** 格式的时间戳（默认）。|`journalctl -o short-iso`|
|**`-n`** 或 **`--lines`**|限制显示的行数（默认为 10 行）。|`journalctl -n 20`|

---

## 📝 总结示例

要查看上一次启动时 `nginx.service` 产生的所有错误和警告日志，您可以使用：

Bash

```
journalctl -b -1 -u nginx.service -p err..warning
```

您希望我为您演示如何使用这些命令来查找您系统上特定服务或时间点的日志吗？