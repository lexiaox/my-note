
`uniq`（unique）命令用于检测和报告文件中的或标准输入中相邻的重复行，并删除重复的行，只保留其中一个。

**重要提示：** `uniq` **只检查相邻的行**。因此，在对包含重复行的文件使用 `uniq` 之前，通常需要先使用 `sort` 命令对文件内容进行排序。

## 1. 基本用法

### **配合 `sort` 去重（最常用组合）**

由于 `uniq` 只检查相邻的行，因此标准的去重流程是先排序，再去重。



```Bash
sort 文件名 | uniq
```

- `sort 文件名`: 对文件内容进行排序。
    
- `|`: 管道符，将 `sort` 的输出作为 `uniq` 的输入。
    
- `uniq`: 去除相邻的重复行。
    

### **对标准输入或文件去重**



```Bash
# 从标准输入读取 (例如，管道的输出)
cat 文件名 | uniq

# 直接对文件内容进行处理 (如果文件中的重复行已经是相邻的)
uniq 文件名
```

### **将结果输出到新文件**



```Bash
sort 文件名 | uniq > 新文件名
```

## 2. 常用选项（标志）

| **选项** | **描述**                                  |
| ------ | --------------------------------------- |
| `-c`   | **计数** (Count)。在每行前面加上该行重复出现的次数。        |
| `-d`   | **只显示**重复的行 (Duplicates)。每个重复组只显示一次。    |
| `-u`   | **只显示**唯一的行 (Unique)。只显示在文件中没有重复的行。     |
| `-i`   | **忽略大小写** (Ignore case)。比较行时忽略字母的大小写差异。 |

## 3. 进阶示例

### **示例 1: 统计每行出现次数**

如果想知道一个文件中有哪些行以及它们各出现了多少次，这是最常用的方法。



```Bash
sort names.txt | uniq -c
```

**输出格式：**

```
   3 Apple
   1 Banana
   2 Orange
```

### **示例 2: 查找所有非重复的行**

只输出那些在文件中只出现了一次的行。



```Bash
sort data.txt | uniq -u
```

### **示例 3: 忽略前 N 个字段或字符**

`uniq` 还可以忽略行中的特定部分进行比较：

- `-f N`: 忽略前 $N$ 个字段（fields）进行比较。
    
    
    
    ```Bash
    # 忽略前两个字段进行比较和去重
    uniq -f 2 文件名
    ```
    
- `-s N`: 忽略前 $N$ 个字符（characters）进行比较。
    
    
    
    ```Bash
    # 忽略前5个字符进行比较和去重
    uniq -s 5 文件名
    ```
    

> **注意：** 字段分隔符默认为空格或制表符。

## 4. `uniq` 与 `sort -u` 的区别

虽然 `sort -u` 也可以用来去重，但它们的工作原理和适用场景略有不同：

- **`sort -u 文件名`**:
    
    - 首先对整个文件进行排序。
        
    - 在排序过程中自动去除重复的行。
        
    - **效率高，是文件去重的首选。**
        
- **`sort 文件名 | uniq`**:
    
    - 首先进行排序。
        
    - 然后通过管道将结果传递给 `uniq` 进行去重。
        
    - **优点：** 允许使用 `uniq -c` 等选项进行计数或只显示重复行，功能更灵活。
        

如果您还有其他关于命令行工具或 Python 的问题，随时可以提问！